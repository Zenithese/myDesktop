(this["webpackJsonpreact-desktop"]=this["webpackJsonpreact-desktop"]||[]).push([[0],{19:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},34:function(e,t,n){},36:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),i=n.n(a),r=n(20),s=n.n(r),o=(n(26),n(9)),l=n(4),u=n(2),d=(n(27),n(7));n(28);function p(e){var t=e.array,n=e.parentClassName,i=e.directionReveal,r=e.folders,s=e.setFolders,o=e.setBackground,p=e.setOpened,b=Object(a.useState)([]),m=Object(u.a)(b,2),j=m[0],g=m[1],h=Object(a.useState)(!0),O=Object(u.a)(h,2),v=O[0],x=O[1],y=0;Object(a.useEffect)((function(){g((function(e){return[].concat(Object(d.a)(e),["closed"])}))}),[y]);var w=t.map((function(e,t){return"li"===e.type?Object(c.jsx)("div",{className:"contextmenu",id:e.id,onClick:function(e){return function(e){if("New Folder"===e.target.innerHTML){var t=Object(l.a)({},r),n=Math.floor(1e15*Math.random());if("App"===e.target.id.slice(3))t[n]={top:e.pageY,left:e.pageX,title:"New Folder",parent:null,children:[],contentX:null,contentY:null,contentWidth:300,contentHeight:300};else{var c=Number(e.target.id.slice(5));t[n]={top:e.pageY,left:e.pageX,title:"New Folder",parent:c,children:[],open:!1,contentX:null,contentY:null,contentWidth:300,contentHeight:300},t[c].children.push(n)}s(t)}else if("Open separate window"===e.target.innerHTML)p((function(t){var n=e.target.id;if(t.includes(Number(n))){var c=document.getElementById("b-".concat(n));return c.className="flash",setTimeout((function(){c.className=""}),2e3),t.push(t.splice(t.indexOf(Number(n)),1)[0]),t}return[].concat(Object(d.a)(t),[Number(n)])}));else if("Delete Folder"===e.target.innerHTML||"Delete File"===e.target.innerHTML){var a=Object(l.a)({},r);!function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.target.id,c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a[n].children&&a[n].children.forEach((function(e){a[e].children&&t(e,!1),p((function(t){return t.filter((function(t){return t!=e}))})),delete a[e]})),c&&("Delete File"===e.target.innerHTML?a[n].parent&&(a[a[n].parent].children=a[a[n].parent].children.filter((function(e){return e!==n}))):a[n].parent&&(a[a[n].parent].children=a[a[n].parent].children.filter((function(e){return e!==Number(n)}))),p((function(e){return e.filter((function(e){return e!=n}))})),delete a[n],s(a))}()}else"Classic Windows"===e.target.innerHTML?o("App background-1"):"Oranges"===e.target.innerHTML?o("App background-2"):"Sky"===e.target.innerHTML&&o("App background-3")}(e)},children:e.text},t):"li with context"===e.type?(y++,Object(c.jsx)(f,{text:e.text,array:e.array,parentClassName:n,openContexts:j,setOpenContexts:g,num:y-1,update:v,setUpdate:x,directionReveal:i,setBackground:o,setOpened:p},t)):null}));return Object(c.jsx)("div",{className:i,children:w})}function f(e){var t=e.text,n=e.array,i=e.parentClassName,r=e.openContexts,s=e.num,o=e.setOpenContexts,l=e.update,d=e.setUpdate,f=e.directionReveal,b=e.setBackground,m=e.setOpened,j=Object(a.useState)("contextmenu"),g=Object(u.a)(j,2),h=g[0],O=g[1];Object(a.useEffect)((function(){"contextmenu"===i&&O("contextmenu")}),[i]),Object(a.useEffect)((function(){"closed"===r[s]&&O("contextmenu")}),[l,r,s]);var v=function(){O("selector"),o((function(e){for(var t=0;t<e.length;t++)e[t]=t===s?"open":"closed";return e})),d(!l)};return Object(c.jsxs)("div",{className:"more-context",onMouseOver:function(){return v()},children:[Object(c.jsx)("div",{className:h,onMouseOver:function(){return v()},onMouseLeave:function(e){return function(e){"contextmenu"!==e.target.className&&(O("contextmenu"),r[s]="closed")}(e)},children:t+" =>"}),Object(c.jsx)("div",{className:"nested-context",children:Object(c.jsx)(p,{array:n,parentClassName:h,directionReveal:f,setBackground:b,setOpened:m})})]})}n(29);var b=n(15),m=n.n(b),j=n(8);function g(e){var t=e.left,n=e.top,i=e.title,r=e.parent,s=e.id,o=e.folders,p=e.setFolders,f=e.dimensions,b=e.opened,g=e.setOpened,h=Object(a.useRef)(null),O=Object(a.useState)(i),v=Object(u.a)(O,2),x=v[0],y=v[1],w=Object(a.useState)("droppable folder"),N=Object(u.a)(w,2),S=N[0],k=N[1],M=Object(a.useState)(0),C=Object(u.a)(M,2),E=C[0],D=C[1],L=Object(a.useState)(0),A=Object(u.a)(L,2),T=A[0],X=A[1],Y=Object(a.useState)(r?"grid":"fixed"),F=Object(u.a)(Y,2),H=F[0],I=F[1],B=Object(a.useState)(t),R=Object(u.a)(B,2),q=R[0],W=R[1],U=Object(a.useState)(n),z=Object(u.a)(U,2),J=z[0],P=z[1],V=Object(a.useState)("0"),G=Object(u.a)(V,2),_=G[0],K=G[1],Q=Object(a.useState)(null),Z=Object(u.a)(Q,2),$=Z[0],ee=Z[1],te=Object(a.useState)([0,0]),ne=Object(u.a)(te,2),ce=ne[0],ae=ne[1],ie=Object(a.useState)(!1),re=Object(u.a)(ie,2),se=re[0],oe=re[1];Object(a.useEffect)((function(){var e=!0;if(se&&$&&e){if(le($.id.slice(2),h.current.id.slice(2)))return alert("Nesting a folder into itself is not permitted"),$.className=$.className.slice(8),void(r?(I(null),ee(null)):(W(ce[0]),P(ce[1]),ee(document.querySelector(".App"))));var t=$.className.split(" "),n=Object(l.a)({},o);return"droppable"===t[1]?(n[n[s].parent]&&(n[n[s].parent].children=n[n[s].parent].children.filter((function(e){return e!==s}))),n[$.id.slice(2)].children.push(Number(s)),n[s].parent=Number($.id.slice(2)),I(null),p(n),$.className=$.className.slice(8)):"App"===$.id&&(n[n[s].parent]&&(n[n[s].parent].children=n[n[s].parent].children.filter((function(e){return e!==s}))),n[s].parent=null,n[s].top=J,n[s].left=q,p(n)),oe(!1),function(){e=!1}}})),Object(a.useEffect)((function(){T&&(document.addEventListener("mousemove",ue),document.addEventListener("mouseup",de))}),[T]),Object(a.useEffect)((function(){null===H?($&&(P($.getBoundingClientRect().top),W($.getBoundingClientRect().left+3)),I("grid")):"fixed"===H&&null!==r&&document.querySelector(".App").appendChild(h.current)}),[H]);var le=function e(t,n){return t==n?(console.log("subfolder conflict"),!0):o[t]&&o[t].parent?e(o[t].parent,n):void 0},ue=function(e){e.preventDefault(),"fixed"!==H&&I("fixed"),h.current&&(P(Math.min(Math.max(0,e.pageY-T),document.body.clientHeight-h.current.offsetHeight)),W(Math.min(Math.max(0,e.pageX-E),document.body.clientWidth-h.current.offsetWidth))),pe(e)},de=function e(t){t.preventDefault(),null!==r&&document.getElementById("c-".concat(r))&&"App"===t.target.parentElement.parentElement.parentElement.id&&document.getElementById("c-".concat(r)).appendChild(h.current),oe(!0),D(0),X(0),K("0"),k("droppable folder"),$||r||ee(document.querySelector(".App")),document.removeEventListener("mousemove",ue),document.removeEventListener("mouseup",e)},pe=function(e){e.preventDefault();var t=e.target.parentElement?e.target.parentElement.parentElement:null;if(t){t.hidden=!0;var n=document.elementFromPoint(e.clientX,e.clientY);if(n=n.closest(".droppable")){var c=document.querySelector(".current");c&&c!==n&&(c.className=c.className.slice(8)),"current"!==n.className.slice(0,7)&&(n.className="current "+n.className,ee(n))}else(n=document.querySelector(".current"))&&(n.className=n.className.slice(8),ee(document.querySelector(".App")));t.hidden=!1}},fe=Object(a.useCallback)(Object(j.debounce)((function(e){var t=Object(l.a)({},o);t[s].title=e,p(t)}),500),[]);return Object(c.jsxs)("div",{id:"f-".concat(s),ref:h,className:S,style:{position:H,top:Math.min(J,f.height-94),left:Math.min(q,f.width-94),zIndex:_},children:[Object(c.jsx)("div",{className:"folder-image-container",children:Object(c.jsx)("img",{draggable:"false",id:s,className:"folder-image",alt:"",src:"http://icon-park.com/imagefiles/folder_icon_yellow.png",onMouseDown:function(e){return function(e){ae([q,J]),k("folder"),K("1000"),D(e.pageX-e.target.getBoundingClientRect().left+5),X(e.pageY-e.target.getBoundingClientRect().top+5)}(e)},onDoubleClick:function(){b.includes(Number(s))||g((function(e){if(o[s].parent){var t=Object(l.a)({},o);t[s].contentX=t[o[s].parent].contentX,t[s].contentY=t[o[s].parent].contentY,p(t),e=e.filter((function(e){return o[s].parent!==e}))}return[].concat(Object(d.a)(e),[Number(s)])}))}})}),Object(c.jsx)("div",{className:"folder-name-container",children:Object(c.jsx)(m.a,{id:"input",html:x,"data-column":"item",className:"content-editable",onChange:function(e){return function(e){var t=e.target.value.replace(/&nbsp;/g," ");y(t),fe(t.length?t:null)}(e)}})})]})}n(19);function h(e){var t=e.id,n=e.width,i=e.setWidth,r=e.height,s=e.setHeight,o=e.setX,d=e.setY,p=e.folders,f=e.setFolders,b=Object(a.useState)(null),m=Object(u.a)(b,2),j=m[0],g=m[1],h=Object(a.useState)(null),O=Object(u.a)(h,2),v=O[0],x=O[1],y=Object(a.useState)(null),w=Object(u.a)(y,2),N=w[0],S=w[1],k=Object(a.useState)(null),M=Object(u.a)(k,2),C=M[0],E=M[1],D=Object(a.useState)(null),L=Object(u.a)(D,2),A=L[0],T=L[1],X=Object(a.useState)(0),Y=Object(u.a)(X,2),F=Y[0],H=Y[1],I=Object(a.useState)(0),B=Object(u.a)(I,2),R=B[0],q=B[1],W=Object(a.useState)(!1),U=Object(u.a)(W,2),z=U[0],J=U[1];Object(a.useEffect)((function(){if(z){var e=Object(l.a)({},p);e[t].contentWidth=n,e[t].contentHeight=r,f(e),J(!1)}})),Object(a.useEffect)((function(){j&&(document.addEventListener("mousemove",P),document.addEventListener("mouseup",V))}),[j]);var P=function(e){e.preventDefault(),"side-top"===j?(s(Math.max(A-e.pageY+N,150)),d(Math.min(e.pageY-R,N+A-R-150))):"side-left"===j?(i(Math.max(C-e.pageX+v,150)),o(Math.min(e.pageX-F,v+C-F-150))):"side-right"===j?i(Math.max(C+e.pageX-v,150)):"side-bottom"===j?s(Math.max(A+e.pageY-N,150)):"corner-1"===j?(i(Math.max(C-e.pageX+v,150)),s(Math.max(A-e.pageY+N,150)),o(Math.min(e.pageX-F,v+C-F-150)),d(Math.min(e.pageY-R,N+A-R-150))):"corner-2"===j?(i(Math.max(C+e.pageX-v,150)),s(Math.max(A-e.pageY+N,150)),d(Math.min(e.pageY-R,N+A-R-150))):"corner-3"===j?(i(Math.max(C-e.pageX+v,150)),s(Math.max(A+e.pageY-N,150)),o(Math.min(e.pageX-F,v+C-F-150))):"corner-4"===j&&(i(Math.max(C+e.pageX-v,150)),s(Math.max(A+e.pageY-N,150)))},V=function e(t){t.preventDefault(),document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",e),g(null),J(!0)};return Object(c.jsxs)("div",{id:"b-".concat(t),onMouseDown:function(e){return function(e){g(e.target.className),x(e.pageX),S(e.pageY),E(n),T(r),H(e.pageX-e.target.getBoundingClientRect().right),q(e.pageY-e.target.getBoundingClientRect().bottom)}(e)},children:[Object(c.jsx)("div",{className:"corner-1"}),Object(c.jsx)("div",{className:"corner-2"}),Object(c.jsx)("div",{className:"corner-3"}),Object(c.jsx)("div",{className:"corner-4"}),Object(c.jsx)("div",{className:"side-top",style:{width:n}}),Object(c.jsx)("div",{className:"side-left",style:{height:r}}),Object(c.jsx)("div",{className:"side-right",style:{height:r}}),Object(c.jsx)("div",{className:"side-bottom",style:{width:n}})]})}n(34);var O=n.p+"static/media/filledDrive.fe42fe8b.png",v="AIzaSyDMu1ATbmk6cgoJhD5oGeRihOsP314WOjY";function x(e){var t=e.id,n=e.title,i=e.parent,r=e.left,s=e.top,o=e.folders,d=e.setFolders,p=e.setCloseSearch,f=e.searchItem,b=e.webViewLink,g=e.iconLink,h=e.accessToken,x=e.dimensions,y=Object(a.useRef)(null),w=Object(a.useState)("file"),N=Object(u.a)(w,2),S=N[0],k=N[1],M=Object(a.useState)("file-name-container"),C=Object(u.a)(M,2),E=C[0],D=C[1],L=Object(a.useState)(null),A=Object(u.a)(L,2),T=A[0],X=A[1],Y=Object(a.useState)(0),F=Object(u.a)(Y,2),H=F[0],I=F[1],B=Object(a.useState)(0),R=Object(u.a)(B,2),q=R[0],W=R[1],U=Object(a.useState)(i?"grid":"fixed"),z=Object(u.a)(U,2),J=z[0],P=z[1],V=Object(a.useState)(r),G=Object(u.a)(V,2),_=G[0],K=G[1],Q=Object(a.useState)(s),Z=Object(u.a)(Q,2),$=Z[0],ee=Z[1],te=Object(a.useState)("0"),ne=Object(u.a)(te,2),ce=ne[0],ae=ne[1],ie=Object(a.useState)(null),re=Object(u.a)(ie,2),se=re[0],oe=re[1],le=Object(a.useState)(!1),ue=Object(u.a)(le,2),de=ue[0],pe=ue[1],fe=Object(a.useState)(!1),be=Object(u.a)(fe,2),me=be[0],je=be[1],ge=Object(a.useState)([0,0]),he=Object(u.a)(ge,2),Oe=(he[0],he[1]);Object(a.useEffect)((function(){if(se&&me){var e=se.className.split(" "),c=Object(l.a)({},o),a=!0;de&&(null===c[t].parent?(alert("".concat(c[t].title," already exist on the desktop")),a=!1):se.id.slice(2)==c[t].parent?alert("".concat(c[t].title," already exist in this folder")):!c[c[t].parent]||window.confirm("".concat(c[t].title," already exist in folder ").concat(c[c[t].parent].title," -- move it?"))?console.log("replacing"):a=!1),c[t]?c[c[t].parent]&&(c[c[t].parent].children=c[c[t].parent].children.filter((function(e){return e!==t}))):c[t]={top:null,left:null,title:n,parent:null,type:"doc",webViewLink:b,iconLink:g},a?"droppable"===e[1]?(c[se.id.slice(2)].children.push(Number(t)?Number(t):t),c[t].parent=Number(se.id.slice(2)),P(null),d(c),se.className=se.className.slice(8)):"App"===se.id&&(c[t].parent=null,c[t].top=$,c[t].left=_,d(c)):d(c),f&&(document.getElementById("results-container").appendChild(y.current),ee(null),K(null)),je(!1)}})),Object(a.useEffect)((function(){q&&(document.addEventListener("mousemove",xe),document.addEventListener("mouseup",ye))}),[q]),Object(a.useEffect)((function(){null===J?(ee(se.getBoundingClientRect().top),K(se.getBoundingClientRect().left+3),P("grid")):"fixed"===J&&null!==i&&document.querySelector(".App").appendChild(y.current)}),[J]);var ve=function(e){o[t]&&e.target.closest(".keep-open")?pe(!0):de&&pe(!1),Oe([_,$]),k("file"),ae("1000"),I(e.pageX-e.target.getBoundingClientRect().left+5),W(e.pageY-e.target.getBoundingClientRect().top+5)},xe=function(e){e.preventDefault(),"fixed"!==J&&P("fixed"),y.current&&(ee(Math.min(Math.max(0,e.pageY-q),document.body.clientHeight-y.current.offsetHeight)),K(Math.min(Math.max(0,e.pageX-H),document.body.clientWidth-y.current.offsetWidth))),we(e)},ye=function e(t){t.preventDefault(),null!==i&&document.getElementById("c-".concat(i))&&"App"===t.target.parentElement.parentElement.parentElement.id&&document.getElementById("c-".concat(i)).appendChild(y.current),I(0),W(0),ae("0"),k("droppable file"),je(!0),se||i||oe(document.querySelector(".App")),document.removeEventListener("mousemove",xe),document.removeEventListener("mouseup",e)},we=function(e){e.preventDefault();var t=e.target.parentElement?e.target.parentElement.parentElement:null;if(t){t.hidden=!0;var n=document.elementFromPoint(e.clientX,e.clientY);document.getElementById("results-open")&&"results-container"!==n.className&&(p(!0),oe(document.querySelector(".App"))),(n=n.closest(".droppable"))?"current"!==n.className.slice(0,7)&&(n.className="current "+n.className,oe(n)):(n=document.querySelector(".current"))&&(n.className=n.className.slice(8),oe(document.querySelector(".App"))),t.hidden=!1}},Ne=Object(a.useCallback)(Object(j.debounce)((function(e){return function(e,t){fetch("https://www.googleapis.com/drive/v3/files/".concat(e,"?key=").concat(v),{headers:{Authorization:"Bearer ".concat(h),"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(t)}),method:"PATCH"})}(t,e)}),500),[]);var Se=function(){window.open(b)};return Object(c.jsxs)("div",{id:"d-".concat(t),ref:y,className:S,style:{position:J,top:Math.min($,x.height-94),left:Math.min(_,x.width-94),zIndex:ce},children:[Object(c.jsxs)("div",{className:"file-image-container",children:[Object(c.jsx)("img",{draggable:"false",id:t,className:"file-image",alt:"",src:O,onMouseDown:function(e){return ve(e)},onDoubleClick:function(){return Se()}}),Object(c.jsx)("img",{draggable:"false",id:t,className:"file-icon",alt:"",src:g,onMouseDown:function(e){return ve(e)},onDoubleClick:function(){return Se()}})]}),Object(c.jsx)("div",{className:E,children:Object(c.jsx)(m.a,{id:"input",html:T||n,"data-column":"item",className:"content-editable",onChange:function(e){return function(e){var t=e.target.value.replace(/&nbsp;/g," ");X(t),Ne(t.length?t:null)}(e)},onFocus:function(){D("file-name-container-focus")},onBlur:function(){D("file-name-container")}})})]})}function y(e){var t=e.id,n=e.children,i=e.folders,r=e.setFolders,s=e.contentX,o=e.contentY,p=e.contentWidth,f=e.contentHeight,b=e.dimensions,m=e.opened,j=e.setOpened,O=e.accessToken,v=Object(a.useRef)(null),y=Object(a.useRef)(null),w=Object(a.useState)(""),N=Object(u.a)(w,2),S=N[0],k=N[1],M=Object(a.useState)(""),C=Object(u.a)(M,2),E=C[0],D=C[1],L=Object(a.useState)(0),A=Object(u.a)(L,2),T=A[0],X=A[1],Y=Object(a.useState)(0),F=Object(u.a)(Y,2),H=F[0],I=F[1],B=Object(a.useState)(s),R=Object(u.a)(B,2),q=R[0],W=R[1],U=Object(a.useState)(o),z=Object(u.a)(U,2),J=z[0],P=z[1],V=Object(a.useState)("droppable contents"),G=Object(u.a)(V,2),_=G[0],K=G[1],Q=Object(a.useState)(p),Z=Object(u.a)(Q,2),$=Z[0],ee=Z[1],te=Object(a.useState)(f),ne=Object(u.a)(te,2),ce=ne[0],ae=ne[1],ie=Object(a.useState)(!1),re=Object(u.a)(ie,2),se=re[0],oe=re[1];Object(a.useEffect)((function(){var e=v.current,t=e.clientWidth,n=e.clientHeight,c=Math.floor(n/100),a=Math.floor(t/100);k("100px ".repeat(c)),D("100px ".repeat(a));for(var i=e.children,r=0;r<i.length;r++)i[r].style.gridRowStart=Math.floor(r/a)+1,i[r].style.gridColumnStart=(r+1)%a||a})),Object(a.useEffect)((function(){H&&(document.addEventListener("mousemove",le),document.addEventListener("mouseup",ue))}),[H]),Object(a.useEffect)((function(){if(se){var e=Object(l.a)({},i);e[t.slice(2)].contentX=q,e[t.slice(2)].contentY=J,r(e),oe(!1)}}),[se,i,t,q,J,r]);var le=function(e){e.preventDefault(),y.current&&(P(Math.min(Math.max(0,e.pageY-H),document.body.clientHeight-y.current.offsetHeight)),W(Math.min(Math.max(0,e.pageX-T),document.body.clientWidth-y.current.offsetWidth)))},ue=function e(n){n.preventDefault(),X(0),I(0),K("droppable contents"),oe(!0),document.removeEventListener("mousemove",le),document.removeEventListener("mouseup",e),j((function(e){return e.push(e.splice(e.indexOf(Number(t.slice(2))),1)[0]),e}))},de=n.map((function(e){return i[e].type?Object(c.jsx)(x,{id:e,top:i[e].top,left:i[e].left,title:i[e].title,parent:i[e].parent,webViewLink:i[e].webViewLink,iconLink:i[e].iconLink,folders:i,setFolders:r,accessToken:O,dimensions:b},e):Object(c.jsx)(g,{id:e,top:i[e].top,left:i[e].left,title:i[e].title,children:i[e].children,parent:i[e].parent,folders:i,setFolders:r,dimensions:b,opened:m,setOpened:j},e)}));return Object(c.jsxs)("div",{ref:y,className:"contents-container",onMouseDown:function(e){return function(e){"close-button"!==e.target.className&&"folder-image"!==e.target.className&&"file-image"!==e.target.className&&"back-button"!==e.target.className&&document.querySelector(".App").appendChild(y.current)}(e)},style:{display:"grid",top:Math.min(J,b.height-ce-5),left:Math.min(q,b.width-$-5),width:"".concat($,"px"),height:"".concat(ce,"px")},children:[Object(c.jsx)(h,{id:t.slice(2),width:$,setWidth:ee,height:ce,setHeight:ae,setX:W,setY:P,folders:i,setFolders:r}),Object(c.jsxs)("div",{className:"contents-handle",onMouseDown:function(e){return function(e){"close-button"!==e.target.className&&"back-button"!==e.target.className&&(K("contents"),document.querySelector(".App").appendChild(y.current),X(e.pageX-e.target.getBoundingClientRect().left),I(e.pageY-e.target.getBoundingClientRect().top))}(e)},children:[Object(c.jsx)("div",{className:"close-button",onClick:function(){return function(){var e=Number(t.slice(2));j((function(t){return t.filter((function(t){return t!==e}))}))}()},children:"\u2716"}),Object(c.jsx)("div",{className:"back-button",onClick:function(){return function(){var e=Number(t.slice(2));i[e].parent&&j((function(t){var n=Object(l.a)({},i);return n[i[e].parent].contentX=n[e].contentX,n[i[e].parent].contentY=n[e].contentY,r(n),t=t.filter((function(t){return t!==e})),[].concat(Object(d.a)(t),[Number(i[e].parent)])}))}()},children:"<"})]}),Object(c.jsx)("div",{id:t,ref:v,className:_,style:{gridTemplateColumns:E,gridTemplateRows:S,width:"".concat($,"px"),height:"".concat(ce-15,"px")},children:de})]})}var w=n(5),N=(n(36),n(16)),S=n(17);function k(e){var t=e.closeSearch,n=e.setCloseSearch,i=e.driveDocuments,r=e.setDriveDocuments,s=e.folders,o=e.setFolders,l=e.dimensions,d=Object(a.useRef)(null),p=Object(a.useState)("fsb"),f=Object(u.a)(p,2),b=f[0],m=f[1],g=Object(a.useState)("results-closed"),h=Object(u.a)(g,2),O=h[0],v=h[1],y=Object(a.useState)(0),k=Object(u.a)(y,2),M=k[0],C=k[1];Object(a.useEffect)((function(){t&&(m("fsb"),n(!1),v("results-closed"))}));var E=function(e){C("right"===e?(M+1)%i.length:M?(M-1)%i.length:i.length-1)},D=Object(a.useCallback)(Object(j.debounce)((function(e){return L(e)}),500),[]),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?w.a.client.drive.files.list({pageSize:10,fields:"nextPageToken, files(kind, id, name, webViewLink, iconLink, mimeType)",q:e}).then((function(e){var t=JSON.parse(e.body);r(t.files)})):r([])};return Object(c.jsxs)("div",{className:"fsb-container keep-open",onClick:function(e){return function(e){"left-arrow"!==e.target.className&&"right-arrow"!==e.target.className&&"fsb-input"!==e.target.className&&"results-open"!==e.target.className&&"input"!==e.target.id&&(C(0),r([]),m("fsb-open"),v("results-open"),d.current.value="",d.current.focus())}(e)},children:[Object(c.jsx)("div",{className:"fsb-left"}),"results-closed"===O?Object(c.jsx)("div",{className:"center-search",children:Object(c.jsx)(N.a,{icon:S.a})}):null,Object(c.jsx)("div",{className:b,children:Object(c.jsx)("input",{ref:d,className:"fsb-input",onChange:function(e){return function(e){D(e.target.value.length?"name contains '".concat(e.target.value,"'"):null)}(e)}})}),Object(c.jsx)("div",{className:"fsb-right"}),i[M]?Object(c.jsxs)("div",{id:O,className:O,children:[Object(c.jsx)("div",{className:"left-arrow",onClick:function(){return E("left")}}),Object(c.jsx)("div",{id:"results-container",className:"results-container",children:function(){if(i[M]){var e=i[M],t=e.id,a=e.name,r=e.webViewLink,u=e.iconLink;return Object(c.jsx)(x,{id:t,title:a,folders:s,left:null,top:null,parent:"search",setFolders:o,setCloseSearch:n,searchItem:!0,webViewLink:r,iconLink:u,dimensions:l})}}()}),Object(c.jsx)("div",{className:"right-arrow",onClick:function(){return E("right")}})]}):null]})}n(40),n(41);var M=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];function C(e){var t=e.folders,n=e.setFolders,i=e.accessToken,r=e.setAccessToken,s=e.signedInUser,o=e.setSignedInUser,l=Object(a.useState)(!1),d=Object(u.a)(l,2),p=d[0],f=d[1],b=Object(a.useState)(null),m=Object(u.a)(b,2),j=m[0],g=m[1];Object(a.useEffect)((function(){var e;s?(e="nerwer_data",w.a.client.drive.files.list({spaces:"appDataFolder",fields:"files(id, name, modifiedTime)"}).execute((function(c){var a=c.files.find((function(t){return t.name===e}));a?w.a.client.drive.files.get({fileId:a.id,alt:"media"}).then((function(e){n(JSON.parse(e.body)),g(a.id),f(!0)})):function(){var e=new Blob([JSON.stringify(t)],{type:"text/javascript"}),n={name:"nerwer_data",mimeType:"text/javascript",parents:["appDataFolder"]},c=new FormData;c.append("metadata",new Blob([JSON.stringify(n)],{type:"application/json"})),c.append("file",e);var a=new XMLHttpRequest;a.open("post","https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id"),a.setRequestHeader("Authorization","Bearer "+i),a.responseType="json",a.onload=function(){console.log(a.response.id)},a.send(c)}()}))):v()}),[s]),Object(a.useEffect)((function(){if(p&&j&&i){var e=new XMLHttpRequest;e.open("PATCH","https://www.googleapis.com/upload/drive/v3/files/"+j+"?uploadType=media"),e.setRequestHeader("Authorization","Bearer "+i),e.responseType="json",e.send(JSON.stringify(t))}}),[t,p,j,i]);var h=function(e){if(e){var t=w.a.auth2.getAuthInstance();o(t.currentUser.je.Qt);var n=Object.keys(t.currentUser)[0],c=Object.keys(t.currentUser[n])[1];r(t.currentUser[n][c].access_token)}},O=function(){w.a.client.init({apiKey:"AIzaSyDMu1ATbmk6cgoJhD5oGeRihOsP314WOjY",clientId:"329272270753-d5i7eltc431nqf4q57lg129aujr0fl0b.apps.googleusercontent.com",discoveryDocs:M,scope:"https://www.googleapis.com/auth/drive  https://www.googleapis.com/auth/drive.appdata"}).then((function(){w.a.auth2.getAuthInstance().isSignedIn.listen(h),h(w.a.auth2.getAuthInstance().isSignedIn.get())}),(function(e){alert(JSON.stringify(e,null,2))}))},v=function(){w.a.load("client:auth2",O)};return Object(c.jsxs)("div",{className:"auth-container",children:[s?Object(c.jsx)("button",{className:"center",onClick:function(){return w.a.auth2.getAuthInstance().signOut(),void o(null)},children:Object(c.jsx)(N.a,{icon:S.b})}):Object(c.jsx)("button",{onClick:function(){w.a.auth2.getAuthInstance().signIn()},children:"Authorize"}),s?" to lose said functionality!":" to gain said functionality!",Object(c.jsx)("button",{style:{position:"fixed",top:"0",left:"0"},onClick:function(){return function(){var e=new XMLHttpRequest;e.open("PATCH","https://www.googleapis.com/upload/drive/v3/files/"+j+"?uploadType=media"),e.setRequestHeader("Authorization","Bearer "+i),e.responseType="json",e.send(JSON.stringify({}))}()},children:"reset"})]})}function E(e){var t=e.signedInUser,n=e.setSignedInUser,a=e.folders,i=e.setFolders,r=e.accessToken,s=e.setAccessToken;return Object(c.jsxs)("div",{className:t?"greeting-closed":"greeting-opened",children:[Object(c.jsx)("span",{className:"greeting-close",children:"\u2716"}),Object(c.jsx)("br",{}),"Welcome to (your) myDesktop: a desktop for Google Drive!",Object(c.jsx)("br",{}),"Use it like your OS desktop",Object(c.jsx)("br",{}),Object(c.jsxs)("ul",{children:[Object(c.jsx)("li",{children:"Drag and drop and nest files and folders"}),Object(c.jsx)("li",{children:"Right click for context menu"}),Object(c.jsx)("li",{children:"Search your drive by clicking on the search button and querying in the input field"})]}),Object(c.jsx)("br",{}),"By authorizing, you are allowing myDesktop to access your Drive through Google DriveAPI. This allows you to search your documents and organize them within the myDesktop UI. Additionally, when you rename your documents on myDesktop, a patch request is sent to your drive to update it there as well. Lastly, your document and folder positions are saved so you can return where you left off.",Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(C,{folders:a,setFolders:i,accessToken:r,setAccessToken:s,signedInUser:t,setSignedInUser:n})]})}var D=function(){var e,t=Object(a.useState)(null),n=Object(u.a)(t,2),i=n[0],r=n[1],s=Object(a.useState)(!1),d=Object(u.a)(s,2),f=d[0],b=d[1],m=Object(a.useState)("App background-1"),j=Object(u.a)(m,2),h=j[0],O=j[1],v=Object(a.useState)("0px"),w=Object(u.a)(v,2),N=w[0],S=w[1],M=Object(a.useState)("0px"),C=Object(u.a)(M,2),D=C[0],L=C[1],A=Object(a.useState)("right-reveal"),T=Object(u.a)(A,2),X=T[0],Y=T[1],F=Object(a.useState)("new-location"),H=Object(u.a)(F,2),I=H[0],B=H[1],R=Object(a.useState)("none"),q=Object(u.a)(R,2),W=q[0],U=q[1],z=Object(a.useState)([]),J=Object(u.a)(z,2),P=J[0],V=J[1],G=Object(a.useState)([]),_=Object(u.a)(G,2),K=_[0],Q=_[1],Z=Object(a.useState)(!1),$=Object(u.a)(Z,2),ee=$[0],te=$[1],ne=Object(a.useState)([]),ce=Object(u.a)(ne,2),ae=ce[0],ie=ce[1],re=Object(a.useState)({}),se=Object(u.a)(re,2),oe=se[0],le=se[1],ue=Object(a.useState)(null),de=Object(u.a)(ue,2),pe=de[0],fe=de[1],be=Object(a.useState)({height:window.innerHeight,width:window.innerWidth}),me=Object(u.a)(be,2),je=me[0],ge=me[1];Object(a.useEffect)((function(){function e(){ge({height:window.innerHeight,width:window.innerWidth})}return window.addEventListener("resize",e),function(t){window.removeEventListener("resize",e)}})),Object(a.useEffect)((function(){B("new-location")}),[I]);var he=function(e,t){var n=Object(l.a)({},oe),c={x:300+15*t,y:300-15*t};K.forEach((function(e){var n=oe[e],a=n.contentX,i=n.contentY;a===c.x&&i===c.y&&(c.x=c.x+15*(K.length-t),c.y=c.y-15*(K.length-t))})),oe[e].contentX=c.x,oe[e].contentY=c.y,le(n)};return Object(c.jsxs)("div",{id:"App",className:h,onClick:function(e){return function(e){e.preventDefault(),U("none"),e.target.closest(".keep-open")||te(!0)}(e)},onContextMenu:function(e){return function(e){e.preventDefault(),U("block"),B("contextmenu"),e.clientX>window.innerWidth/4*3?(e.clientY>window.innerHeight/4*3?Y("left-reveal bottom"):Y("left-reveal"),S(e.clientY+"px"),L(e.clientX+160+"px")):(e.clientY>window.innerHeight/4*3?Y("right-reveal bottom"):Y("right-reveal"),S(e.clientY+"px"),L(e.clientX+5+"px")),"folder-image"===e.target.className?V([{type:"li",text:"Delete Folder",id:e.target.id},{type:"li",text:"Open separate window",id:e.target.id}]):"file-image"===e.target.className?V([{type:"li",text:"Delete File",id:e.target.id}]):V([{type:"li",text:"New Folder",id:"nf-".concat(e.target.id)},{type:"li with context",text:"Change Background",array:[{type:"li",text:"Classic Windows"},{type:"li",text:"Oranges"},{type:"li",text:"Sky"}]}])}(e)},children:[Object(c.jsx)(E,(e={displayGreeting:f,setDisplayGreeting:b,folders:oe,setFolders:le,accessToken:pe,setAccessToken:fe},Object(o.a)(e,"setDisplayGreeting",b),Object(o.a)(e,"signedInUser",i),Object(o.a)(e,"setSignedInUser",r),e)),Object(c.jsx)("div",{style:{display:W,position:"fixed",top:N,left:D,flexDirection:"row-reverse",zIndex:"10000"},children:Object(c.jsx)(p,{parentClassName:I,directionReveal:X,folders:oe,setFolders:le,array:P,setBackground:O,setOpened:Q})}),function(){var e=[];for(var t in oe)null===oe[t].parent&&e.push(oe[t].type?Object(c.jsx)(x,{id:t,top:oe[t].top,left:oe[t].left,title:oe[t].title,parent:oe[t].parent,webViewLink:oe[t].webViewLink,iconLink:oe[t].iconLink,folders:oe,setFolders:le,accessToken:pe,dimensions:je},t):Object(c.jsx)(g,{id:t,top:oe[t].top,left:oe[t].left,title:oe[t].title,folders:oe,setFolders:le,parent:null,dimensions:je,opened:K,setOpened:Q},t));return e}(),K.map((function(e,t){return null===oe[e].contentX&&he(e,t),Object(c.jsx)(y,{id:"c-".concat(e),children:oe[e].children,folders:oe,setFolders:le,contentX:oe[e].contentX,contentY:oe[e].contentY,contentWidth:oe[e].contentWidth,contentHeight:oe[e].contentHeight,dimensions:je,opened:K,setOpened:Q,accessToken:pe},"c-".concat(e))})),Object(c.jsx)(k,{closeSearch:ee,setCloseSearch:te,driveDocuments:ae,setDriveDocuments:ie,folders:oe,setFolders:le,dimensions:je})]})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,43)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),i(e),r(e)}))};s.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(D,{})}),document.getElementById("root")),L()}},[[42,1,2]]]);
//# sourceMappingURL=main.e3d2a921.chunk.js.map